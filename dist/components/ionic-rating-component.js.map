{"version":3,"file":"ionic-rating-component.js","sourceRoot":"","sources":["../../src/components/ionic-rating-component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { IonicRatingSubscriptionService } from '..';\n\n@Component({\n  selector: 'ionic-rating-component',\n  template: `\n<div class=\"ionic5-star-rating\">\n  <button [ngStyle]=\"{'width' : fontSize, 'height' : fontSize}\" *ngFor=\"let index of iconsArray\" id=\"{{index}}\" type=\"button\" ion-button icon-only (click)=\"changeRating($event)\">\n    <ion-icon [ngStyle]=\"{'color':index < this.Math.round(this.parseFloat(rating)) ? activeColor : defaultColor, 'font-size' : fontSize }\" name=\"{{(halfStar ==='true' && (rating - index > 0) && (rating - index <= 0.5)) ? halfIcon : (index < this.Math.round(this.parseFloat(rating))) ? activeIcon : defaultIcon}}\"></ion-icon>\n  </button>\n</div>\n`,\n  styles: [`\n    .ionic-rating-component button {\n        background: none;\n        box-shadow: none;\n        -webkit-box-shadow: none;\n        padding : 0px;\n    }\n`],\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: IonicRatingComponent,\n      multi: true,\n    },\n  ],\n})\nexport class IonicRatingComponent implements ControlValueAccessor, OnInit {\n\n  ngOnInit(): void {\n    this.rating = this.rating || 3; //default after input`s initialization\n    for (let i = 0; i < this.maxRating; i++) {\n      this.iconsArray.push(i);\n    }\n  }\n\n  public readonly eventInfo = (() => {\n    const id = new Date().getTime();\n    const topic = `star-rating:${id}:changed`;\n    return {\n      topic,\n    };\n  })();\n\n  private _rating: number;\n  private onChange: any;\n  private onTouched: any;\n  public disabled: boolean;\n\n  writeValue(obj: number): void {\n    this.rating = obj;\n  }\n\n  registerOnChange(fn: any): void {\n    this.onChange = fn;\n  }\n\n  registerOnTouched(fn: any): void {\n    this.onTouched = fn;\n  }\n\n  setDisabledState?(isDisabled: boolean): void {\n    this.readonly = isDisabled ? \"true\" : \"false\";\n  }\n\n  @Input()\n  public set rating(val: number) {\n    this._rating = val;\n    if (this.onChange) {\n      this.onChange(val);\n    }\n  }\n\n  public get rating(): number {\n    return this._rating;\n  }\n\n  @Output()\n  ratingChanged: EventEmitter<number> = new EventEmitter<number>();\n\n  @Input()\n  readonly: string = \"false\";\n  @Input()\n  activeColor: string = '#488aff';\n  @Input()\n  defaultColor: string = '#aaaaaa';\n  @Input()\n  activeIcon: string = 'ios-star';\n  @Input()\n  defaultIcon: string = 'ios-star-outline';\n  @Input()\n  halfIcon: string = 'ios-star-half';\n  @Input()\n  halfStar: string = \"false\";\n  @Input()\n  maxRating: number = 5;\n  @Input()\n  fontSize: string = '28px';\n  Math: any;\n  parseFloat: any;\n  iconsArray: number[] = [];\n\n  constructor(private ionic5StartRatingSubscriptionService: IonicRatingSubscriptionService) {\n    this.Math = Math;\n    this.parseFloat = parseFloat;\n  }\n\n  changeRating(event) {\n    if (this.readonly && this.readonly === \"true\") return;\n    // event is different for firefox and chrome\n    let id = event.target.id ? parseInt(event.target.id) : parseInt(event.target.parentElement.id);\n    if (this.halfStar && this.halfStar === \"true\") {\n      this.rating = ((this.rating - id > 0) && (this.rating - id <= 0.5)) ? id + 1 : id + .5;\n    } else {\n      this.rating = id + 1;\n    }\n    // subscribe this event to get the changed value in your parent compoanent \n    this.ionic5StartRatingSubscriptionService.publishStartRatingChanged(this.rating);\n    this.ionic5StartRatingSubscriptionService.publishTopic(this.eventInfo.topic, this.rating);\n    // unique event\n    this.ratingChanged.emit(this.rating);\n  }\n}\n"]}